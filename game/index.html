<!doctype html>
<html lang="en">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
<title>FORBIDDEN YOGA — GAME</title>
<style>
  html,body{margin:0;background:#000;color:#cfe6ff;font:14px/1 system-ui}
  #wrap{position:relative;height:100svh;display:flex;flex-direction:column}
  header{text-align:center;font-weight:800;font-size:26px;padding:8px 0}
  #stage{flex:1;display:grid;place-items:center}
  canvas{background:#000;outline:1px solid #222;width:100vw;height:100svh}
  .hud{position:fixed;left:8px;bottom:8px;font-size:12px;opacity:.9;z-index:2}
  .controls{position:fixed;bottom:56px;left:0;right:0;display:flex;justify-content:space-between;padding:0 14px;pointer-events:none;z-index:2}
  .btn{pointer-events:auto;width:84px;height:84px;border:2px solid #234;border-radius:14px;background:#0a1320aa;color:#cfe6ff;display:grid;place-items:center;font-size:26px;user-select:none}
  @media (min-width:900px){.controls{display:none}}
  footer{color:#8aa;font-size:10px;text-align:center;padding:6px 4px}
</style>
<body>
<div id="wrap">
  <header>FORBIDDEN YOGA</header>
  <div id="stage"><canvas id="game"></canvas></div>

  <div class="controls">
    <div class="btn" id="left">◄</div>
    <div class="btn" id="right">►</div>
  </div>

  <div class="hud" id="hud">SCORE 0000   LEVEL 1</div>
  <footer>Hi there! If you heard about our project, you may get in touch with us under love at forbiddenyoga.com</footer>
</div>

<script>
const cvs=document.getElementById('game')
const ctx=cvs.getContext('2d',{alpha:false})
ctx.imageSmoothingEnabled=false

let DESKTOP=false,W=360,H=640
function resize(){
  DESKTOP = innerWidth >= 900
  W = DESKTOP ? innerWidth : 420
  H = DESKTOP ? innerHeight : 760
  const dpr=Math.max(1,devicePixelRatio||1)
  cvs.width=Math.floor(W*dpr)
  cvs.height=Math.floor(H*dpr)
  cvs.style.width=W+'px'
  cvs.style.height=H+'px'
  ctx.setTransform(dpr,0,0,dpr,0,0)
}
addEventListener('resize',resize); resize()

function P(){ return DESKTOP ? {
  SPRITE:128, SHIP:560, BULLET:980, FALL_MIN:180, FALL_JIT:120, STARS:30
} : {
  SPRITE:128, SHIP:380, BULLET:760, FALL_MIN:140, FALL_JIT:100, STARS:22
}}
let pr=P(); addEventListener('resize',()=>{ pr=P(); rebuildSprites() })

const rnd=()=>Math.random()
const stars=[...Array(320)].map(()=>({x:rnd(),y:rnd(),s:rnd()*2+.5,c:rnd()<.08?'#9cf':'#556b8b'}))

const ship={x:W/2,y:0}; function placeShip(){ ship.y=H-100 } placeShip()
let leftHeld=false,rightHeld=false,spaceDown=false
let score=0,level=1

const bullets=[]; let shootTimer=0

function rect(g,x,y,w,h,c){ g.fillStyle=c; g.fillRect(Math.round(x),Math.round(y),w,h) }

// high-res sprites 128x128, male and female
let sprM, sprF
function buildYogiSprite(sex){
  const S=pr.SPRITE, s=document.createElement('canvas'); s.width=S; s.height=S
  const g=s.getContext('2d'); g.imageSmoothingEnabled=false
  const P=(x,y,w,h,c)=>rect(g,x,y,w,h,c)

  // cushion
  P(18,100,92,10,'#e6e6e6'); P(26,96,76,6,'#dcdcdc')

  // crossed legs + robe base
  P(30,88,24,8,'#fafafa'); P(74,88,24,8,'#fafafa')
  P(36,82,56,10,'#ffffff')

  // torso robe with shading
  P(44,56,40,28,'#ffffff')
  P(40,60,4,22,'#f0f0f0'); P(84,60,4,22,'#f0f0f0')

  // folded arms
  P(34,66,10,8,'#ededed'); P(84,66,10,8,'#ededed')
  P(46,70,36,6,'#e9e9e9')

  // neck
  P(60,52,8,4,'#f3c28f')

  // head
  P(48,34,32,18,'#f5c79a'); P(50,32,28,4,'#f5c79a')

  // turban
  P(44,24,40,5,'#ffffff')
  P(48,20,32,4,'#ffffff')
  P(52,18,24,2,'#ffffff')

  // face accents
  P(56,46,4,2,'#2a2a2a'); P(68,46,4,2,'#2a2a2a') // eyes
  if(sex==='m'){ P(56,50,16,2,'#c7b299') }        // beard line
  else { P(55,49,18,1,'#f3c28f'); P(55,51,18,1,'#f3c28f') } // soft mouth line

  // robe highlights
  P(44,78,4,8,'#eeeeee'); P(80,78,4,8,'#eeeeee')

  return s
}
function rebuildSprites(){ sprM=buildYogiSprite('m'); sprF=buildYogiSprite('f') }
rebuildSprites()

function spawnYogi(){
  const m=pr.SPRITE*0.6
  return {x:m+rnd()*(W-2*m), y:-pr.SPRITE - rnd()*300,
          v:pr.FALL_MIN + rnd()*pr.FALL_JIT,
          sex:rnd()<.5?'m':'f'}
}
let yogis=[...Array(5)].map(spawnYogi)

function drawStarfield(dt){
  rect(ctx,0,0,W,H,'#000')
  for(const t of stars){
    rect(ctx,t.x*W,t.y*H,t.s,t.s,t.c)
    t.y=(t.y + (pr.STARS/H)*dt*H) % 1
  }
}
function drawShip(){
  rect(ctx,ship.x-5,ship.y-18,10,18,'#3fd092')
  rect(ctx,ship.x-12,ship.y-9,24,9,'#2aa579')
  rect(ctx,ship.x-18,ship.y-4,36,4,'#1b6e53')
}
function drawYogi(y){
  ctx.drawImage(y.sex==='m'?sprM:sprF, y.x-pr.SPRITE/2, y.y-pr.SPRITE/2)
}

let last=performance.now(), dt=0
function loop(t){
  dt=(t-last)/1000; last=t
  update(dt); render(dt)
  requestAnimationFrame(loop)
}
function update(dt){
  const dir=(rightHeld?1:0)-(leftHeld?1:0)
  ship.x=Math.max(24,Math.min(W-24,ship.x+dir*pr.SHIP*dt))

  shootTimer-=dt
  if(spaceDown && shootTimer<=0){
    bullets.push({x:ship.x,y:ship.y-18,v:pr.BULLET}); shootTimer=.1
  }
  for(const b of bullets) b.y-=b.v*dt
  while(bullets.length && bullets[0].y<-60) bullets.shift()

  for(const y of yogis){
    y.y+=y.v*dt
    if(y.y>H+pr.SPRITE) Object.assign(y,spawnYogi())
  }

  const w=pr.SPRITE*0.7, h=pr.SPRITE*0.9
  for(const b of bullets){
    for(const y of yogis){
      if(b.x>y.x-w/2 && b.x<y.x+w/2 && b.y>y.y-h/2 && b.y<y.y+h/2){
        score+=10; Object.assign(y,spawnYogi()); b.y=-9999
      }
    }
  }
  hud.textContent=`SCORE ${String(score).padStart(4,'0')}   LEVEL ${level}`
}
function render(dt){
  drawStarfield(dt)
  for(const y of yogis) drawYogi(y)
  for(const b of bullets) rect(ctx,b.x-1,b.y-10,2,18,'#ffe08a')
  drawShip()
}

// input
addEventListener('keydown',e=>{
  const k=e.key.toLowerCase()
  if(k==='arrowleft'||k==='a') leftHeld=true
  if(k==='arrowright'||k==='d') rightHeld=true
  if(k===' ') spaceDown=true
})
addEventListener('keyup',e=>{
  const k=e.key.toLowerCase()
  if(k==='arrowleft'||k==='a') leftHeld=false
  if(k==='arrowright'||k==='d') rightHeld=false
  if(k===' ') spaceDown=false
})
left.addEventListener('touchstart',e=>{e.preventDefault();leftHeld=true})
left.addEventListener('touchend',e=>{e.preventDefault();leftHeld=false})
right.addEventListener('touchstart',e=>{e.preventDefault();rightHeld=true})
right.addEventListener('touchend',e=>{e.preventDefault();rightHeld=false})

requestAnimationFrame(loop)
</script>
